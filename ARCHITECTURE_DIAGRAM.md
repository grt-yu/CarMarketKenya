# ğŸ—ï¸ Kenya Car Marketplace - System Architecture

## Application Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React + TypeScript)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± Pages                    ğŸ§© Components                          â”‚
â”‚  â”œâ”€â”€ Home                   â”œâ”€â”€ CarCard                             â”‚
â”‚  â”œâ”€â”€ Cars Listing          â”œâ”€â”€ SearchForm                          â”‚
â”‚  â”œâ”€â”€ Car Details           â”œâ”€â”€ AIPricingWidget                     â”‚
â”‚  â”œâ”€â”€ Sell Car              â”œâ”€â”€ MpesaPayment                        â”‚
â”‚  â”œâ”€â”€ Messages              â”œâ”€â”€ MessageChat                         â”‚
â”‚  â”œâ”€â”€ Blog                  â””â”€â”€ CarForm                             â”‚
â”‚  â””â”€â”€ Profile                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ HTTP/WebSocket
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND (Express + TypeScript)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ›£ï¸ API Routes              ğŸ”§ Services                            â”‚
â”‚  â”œâ”€â”€ /api/cars             â”œâ”€â”€ AICarPricing                        â”‚
â”‚  â”œâ”€â”€ /api/messages         â”œâ”€â”€ MpesaIntegration                     â”‚
â”‚  â”œâ”€â”€ /api/blog             â”œâ”€â”€ DatabaseStorage                     â”‚
â”‚  â”œâ”€â”€ /api/mpesa            â””â”€â”€ WebSocket Server                    â”‚
â”‚  â”œâ”€â”€ /api/ai/*                                                     â”‚
â”‚  â””â”€â”€ /api/users                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                    â”‚                    â”‚
                â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PostgreSQL    â”‚    â”‚   DeepSeek AI   â”‚    â”‚     M-Pesa      â”‚
â”‚    Database     â”‚    â”‚      API        â”‚    â”‚   Gateway       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Users         â”‚    â”‚ â€¢ Car Pricing   â”‚    â”‚ â€¢ STK Push      â”‚
â”‚ â€¢ Cars          â”‚    â”‚ â€¢ Comparison    â”‚    â”‚ â€¢ Callbacks     â”‚
â”‚ â€¢ Messages      â”‚    â”‚ â€¢ History       â”‚    â”‚ â€¢ Validation    â”‚
â”‚ â€¢ Blog Posts    â”‚    â”‚   Analysis      â”‚    â”‚                 â”‚
â”‚ â€¢ Payments      â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ Analytics     â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Search/Filter    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    AI Analysis    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   CAR API   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ DEEPSEEK AI â”‚
â”‚ (Buyer)     â”‚                     â”‚             â”‚                    â”‚   SERVICE   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚                                   â”‚
      â”‚ Message                            â”‚ Store                             â”‚
      â–¼                                    â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Real-time        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Pricing Data    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WEBSOCKET   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  DATABASE   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  PRICING    â”‚
â”‚   SERVER    â”‚                     â”‚ PostgreSQL  â”‚                     â”‚  ANALYSIS   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚
      â”‚ Chat Messages                      â”‚ Payment Records
      â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Payment          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    USER     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ M-PESA API  â”‚
â”‚ (Seller)    â”‚                     â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Feature Integration Map

```
ğŸš— CAR LISTINGS
â”œâ”€â”€ ğŸ” Advanced Search & Filters
â”œâ”€â”€ ğŸ¤– AI-Powered Pricing Analysis
â”œâ”€â”€ ğŸ“Š Market Comparison Tools
â”œâ”€â”€ ğŸ“ˆ Performance Analytics
â””â”€â”€ ğŸ·ï¸ Status Management

ğŸ’¬ REAL-TIME MESSAGING
â”œâ”€â”€ ğŸ”„ WebSocket Communication
â”œâ”€â”€ ğŸ“± Mobile-Optimized Interface
â”œâ”€â”€ ğŸ“ Message History
â””â”€â”€ ğŸ”” Notification System

ğŸ’³ PAYMENT PROCESSING
â”œâ”€â”€ ğŸ“± M-Pesa Integration
â”œâ”€â”€ ğŸ’° Multiple Payment Types
â”œâ”€â”€ ğŸ§¾ Transaction Records
â””â”€â”€ ğŸ”’ Security Features

ğŸ‘¤ USER MANAGEMENT
â”œâ”€â”€ âœ… Seller Verification
â”œâ”€â”€ â­ Rating System
â”œâ”€â”€ ğŸ“‹ Profile Management
â””â”€â”€ ğŸ¢ Dealer vs Individual

ğŸ“ CONTENT SYSTEM
â”œâ”€â”€ ğŸ“° Blog Management
â”œâ”€â”€ ğŸ”— SEO Optimization
â”œâ”€â”€ ğŸ“‚ Category Organization
â””â”€â”€ ğŸ–¼ï¸ Media Management
```

## Technology Stack Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TECH STACK                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Frontend:                     Backend:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   React     â”‚              â”‚   Node.js   â”‚                      â”‚
â”‚  â”‚ TypeScript  â”‚              â”‚   Express   â”‚                      â”‚
â”‚  â”‚ Tailwind    â”‚              â”‚ TypeScript  â”‚                      â”‚
â”‚  â”‚ shadcn/ui   â”‚              â”‚             â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                     â”‚
â”‚  Database:                     AI/ML:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ PostgreSQL  â”‚              â”‚ DeepSeek AI â”‚                      â”‚
â”‚  â”‚ Drizzle ORM â”‚              â”‚  Pricing    â”‚                      â”‚
â”‚  â”‚   Schemas   â”‚              â”‚ Comparison  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                     â”‚
â”‚  Payments:                     Real-time:                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚   M-Pesa    â”‚              â”‚ WebSockets  â”‚                      â”‚
â”‚  â”‚ Integration â”‚              â”‚    Chat     â”‚                      â”‚
â”‚  â”‚ STK Push    â”‚              â”‚ Messaging   â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security & Performance Features

```
ğŸ”’ SECURITY LAYERS
â”œâ”€â”€ Input Validation (Zod Schemas)
â”œâ”€â”€ SQL Injection Prevention (Drizzle ORM)
â”œâ”€â”€ Password Hashing (bcrypt)
â”œâ”€â”€ Session Management
â”œâ”€â”€ CSRF Protection
â””â”€â”€ Environment Variables Protection

âš¡ PERFORMANCE OPTIMIZATIONS
â”œâ”€â”€ Database Query Optimization
â”œâ”€â”€ Image Lazy Loading
â”œâ”€â”€ Component Code Splitting
â”œâ”€â”€ Caching Strategies
â”œâ”€â”€ Mobile-First Design
â””â”€â”€ SEO Optimization
```